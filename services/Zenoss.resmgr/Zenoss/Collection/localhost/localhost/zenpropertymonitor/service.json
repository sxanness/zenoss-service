{
    "RAMCommitment": "256M", 
    "Description": "Monitor a numeric property", 
    "Launch": "auto", 
    "Tags": [
        "ZenPacks.zenoss.PropertyMonitor", 
        "daemon", 
        "collector"
    ], 
    "MonitoringProfile": {
        "ThresholdConfigs": [
            {
                "EventTags": {
                    "Explanation": "This service is missing runs", 
                    "EventClass": "/App/Zenoss", 
                    "Resolution": "Add more collectors", 
                    "Severity": 3
                }, 
                "Name": "Missed Runs High", 
                "MetricSource": "zenpropertymonitor", 
                "Threshold": {
                    "Max": "5", 
                    "Min": ""
                }, 
                "DataPoints": [
                    "missedRuns"
                ], 
                "Type": "MinMax", 
                "ID": "missedRuns.high", 
                "Description": "High number of missed runs"
            }
        ], 
        "MetricConfigs": [
            {
                "Metrics": [
                    {
                        "Name": "Datapoints", 
                        "Counter": true, 
                        "Description": "Number of datapoints collected.", 
                        "Unit": "Points", 
                        "ID": "dataPoints"
                    }, 
                    {
                        "Name": "Devices", 
                        "Counter": false, 
                        "Description": "Number of devices.", 
                        "Unit": "Count", 
                        "ID": "devices"
                    }, 
                    {
                        "Name": "Event Count", 
                        "Counter": true, 
                        "Description": "Total number of events.", 
                        "Unit": "Events", 
                        "ID": "eventCount"
                    }, 
                    {
                        "Name": "Event Queue Length", 
                        "Counter": false, 
                        "Description": "The number of events pending to be flushed from a daemon's memory queue.", 
                        "Unit": "Events", 
                        "ID": "eventQueueLength"
                    }, 
                    {
                        "Name": "Missed Runs", 
                        "Counter": true, 
                        "Description": "Number of missed runs of tasks running on daemon.", 
                        "Unit": "Runs", 
                        "ID": "missedRuns"
                    }, 
                    {
                        "Name": "Queued Tasks", 
                        "Counter": false, 
                        "Description": "Number of tasks scheduled to be run, but are not running yet.", 
                        "Unit": "Tasks", 
                        "ID": "queuedTasks"
                    }, 
                    {
                        "Name": "Running Tasks", 
                        "Counter": false, 
                        "Description": "Number of currently running tasks.", 
                        "Unit": "Tasks", 
                        "ID": "runningTasks"
                    }, 
                    {
                        "Name": "Task Count", 
                        "Counter": false, 
                        "Description": "Total number of tasks.", 
                        "Unit": "Tasks", 
                        "ID": "taskCount"
                    }
                ], 
                "Name": "zenpropertymonitor internal metrics", 
                "Description": "zenpropertymonitor internal metrics", 
                "ID": "zenpropertymonitor"
            }
        ], 
        "GraphConfigs": [
            {
                "description": "Number of datapoints collected.", 
                "footer": false, 
                "yAxisLabel": "Data Points", 
                "range": {
                    "start": "1h-ago", 
                    "end": "0s-ago"
                }, 
                "returnset": "EXACT", 
                "datapoints": [
                    {
                        "name": "Data Points", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "dataPoints", 
                        "id": "dataPoints", 
                        "rate": true, 
                        "type": "line", 
                        "legend": "Data Points", 
                        "fill": false
                    }
                ], 
                "type": "line", 
                "id": "dataPoints", 
                "name": "Data Points"
            }, 
            {
                "description": "Number of devices.", 
                "footer": false, 
                "yAxisLabel": "Devices", 
                "range": {
                    "start": "1h-ago", 
                    "end": "0s-ago"
                }, 
                "returnset": "EXACT", 
                "datapoints": [
                    {
                        "name": "Devices", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "devices", 
                        "id": "devices", 
                        "rate": false, 
                        "type": "line", 
                        "legend": "Devices", 
                        "fill": false
                    }
                ], 
                "type": "line", 
                "id": "devices", 
                "name": "Devices"
            }, 
            {
                "description": "Total number of events.", 
                "footer": false, 
                "yAxisLabel": "Event Count", 
                "range": {
                    "start": "1h-ago", 
                    "end": "0s-ago"
                }, 
                "returnset": "EXACT", 
                "datapoints": [
                    {
                        "name": "Event Count", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "eventCount", 
                        "id": "eventCount", 
                        "rate": true, 
                        "type": "line", 
                        "legend": "Event Count", 
                        "fill": false
                    }
                ], 
                "type": "line", 
                "id": "eventCount", 
                "name": "Event Count"
            }, 
            {
                "description": "The number of events pending to be flushed from a daemon's memory queue.", 
                "footer": false, 
                "yAxisLabel": "Event Queue Length", 
                "range": {
                    "start": "1h-ago", 
                    "end": "0s-ago"
                }, 
                "returnset": "EXACT", 
                "datapoints": [
                    {
                        "name": "Event Queue Length", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "eventQueueLength", 
                        "id": "eventQueueLength", 
                        "rate": false, 
                        "type": "line", 
                        "legend": "Event Queue Length", 
                        "fill": false
                    }
                ], 
                "type": "line", 
                "id": "eventQueueLength", 
                "name": "Event Queue Length"
            }, 
            {
                "description": "Number of missed runs of tasks running on daemon.", 
                "footer": false, 
                "yAxisLabel": "Missed Runs", 
                "range": {
                    "start": "1h-ago", 
                    "end": "0s-ago"
                }, 
                "returnset": "EXACT", 
                "datapoints": [
                    {
                        "name": "Missed Runs", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "missedRuns", 
                        "id": "missedRuns", 
                        "rate": true, 
                        "type": "line", 
                        "legend": "Missed Runs", 
                        "fill": false
                    }
                ], 
                "type": "line", 
                "id": "missedRuns", 
                "name": "Missed Runs"
            }, 
            {
                "description": "Number of queued, running, and total tasks.", 
                "footer": false, 
                "yAxisLabel": "", 
                "range": {
                    "start": "1h-ago", 
                    "end": "0s-ago"
                }, 
                "returnset": "EXACT", 
                "datapoints": [
                    {
                        "name": "Queued Tasks", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "queuedTasks", 
                        "id": "queuedTasks", 
                        "rate": false, 
                        "type": "line", 
                        "legend": "Queued Tasks", 
                        "fill": false
                    }, 
                    {
                        "name": "Running Tasks", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "runningTasks", 
                        "id": "runningTasks", 
                        "rate": false, 
                        "type": "line", 
                        "legend": "Running Tasks", 
                        "fill": false
                    }, 
                    {
                        "name": "Task Count", 
                        "metricSource": "zenpropertymonitor", 
                        "aggregator": "avg", 
                        "metric": "taskCount", 
                        "id": "taskCount", 
                        "rate": false, 
                        "type": "line", 
                        "legend": "Task Count", 
                        "fill": false
                    }
                ], 
                "type": "line", 
                "id": "tasks", 
                "name": "Tasks"
            }
        ]
    }, 
    "Actions": {
        "debug": "su - zenoss -c '${ZENHOME:-/opt/zenoss}/bin/{{.Name}} debug'", 
        "stats": "su - zenoss -c '${ZENHOME:-/opt/zenoss}/bin/{{.Name}} stats'"
    }, 
    "ChangeOptions": [
        "restartAllOnInstanceChanged"
    ], 
    "ConfigFiles": {
        "/opt/zenoss/etc/zenpropertymonitor.conf": {
            "Owner": "zenoss:zenoss", 
            "Permissions": "0664", 
            "FileName": "/opt/zenoss/etc/zenpropertymonitor.conf"
        }, 
        "/opt/zenoss/etc/global.conf": {
            "Content": "# Generated by serviced\n{{range $k,$v:=contextFilter . \"global.conf.\"}}{{$k}} {{$v}}\n{{end}}", 
            "Owner": "zenoss:zenoss", 
            "Permissions": "660", 
            "Filename": "/opt/zenoss/etc/global.conf"
        }
    }, 
    "Instances": {
        "min": 1
    }, 
    "Command": "su - zenoss -c \"/opt/zenoss/bin/zenpropertymonitor run -c --logfileonly --workers {{.Instances}} --workerid $CONTROLPLANE_INSTANCE_ID --monitor {{(parent .).Name}} \"", 
    "Name": "zenpropertymonitor", 
    "Volumes": [
        {
            "Owner": "zenoss:zenoss", 
            "ResourcePath": ".ssh", 
            "Type": "", 
            "ContainerPath": "/home/zenoss/.ssh", 
            "Permission": "0755"
        }, 
        {
            "Owner": "zenoss:zenoss", 
            "ResourcePath": "var-zenpacks", 
            "ContainerPath": "/var/zenoss", 
            "Permission": "0775"
        }
    ], 
    "HealthChecks": {
        "redis_answering": {
            "Interval": 5.0, 
            "Script": "/opt/zenoss/bin/healthchecks/redis_answering"
        }, 
        "running": {
            "Interval": 5.0, 
            "Script": "pgrep -fu zenoss zenpropertymonitor.py > /dev/null"
        }, 
        "zenhub_answering": {
            "Interval": 10.0, 
            "Script": "/opt/zenoss/bin/healthchecks/zenhub_answering"
        }
    }, 
    "Services": [], 
    "CPUCommitment": 1, 
    "ImageID": "zenoss/zenoss5x", 
    "Endpoints": [
        {
            "Protocol": "tcp", 
            "Application": "zproxy", 
            "PortNumber": 8080, 
            "Name": "zproxy", 
            "Purpose": "import"
        }, 
        {
            "Protocol": "tcp", 
            "Application": "{{(parent (parent .)).Name}}_zenhubPB", 
            "PortNumber": 8789, 
            "Name": "zenhub", 
            "Purpose": "import"
        }, 
        {
            "Protocol": "tcp", 
            "Application": "{{(parent .).Name}}_redis", 
            "PortNumber": 6379, 
            "Name": "CollectorRedis", 
            "Purpose": "import"
        }, 
        {
            "Protocol": "tcp", 
            "Application": "controlplane_consumer", 
            "PortNumber": 8444, 
            "Name": "controlplane_consumer", 
            "Purpose": "import"
        }
    ], 
    "LogConfigs": [
        {
            "path": "/opt/zenoss/log/zenpropertymonitor.log", 
            "type": "zenpropertymonitor", 
            "filters": [
                "pythondaemon"
            ], 
            "LogTags": [
                {
                    "Name": "monitor", 
                    "Value": "{{(parent .).Name}}"
                }
            ]
        }, 
        {
            "path": "/opt/zenoss/log/audit.log", 
            "type": "zenossaudit", 
            "filters": [
                "supervisord"
            ]
        }
    ]
}